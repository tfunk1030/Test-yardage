<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golf Yardage Calculator</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-3xl">
        <header class="text-center mb-8 animate-fade-in">
            <h1 class="text-4xl font-bold text-gray-900 mb-2">Golf Yardage Calculator</h1>
            <p class="text-gray-600">Calculate accurate yardages based on environmental conditions</p>
        </header>

        <main>
            <!-- Environmental Conditions Card -->
            <div class="card mb-8">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">Environmental Conditions</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1" for="temperature">
                            Temperature (°F)
                        </label>
                        <input type="number" id="temperature" class="input-field" placeholder="70">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1" for="humidity">
                            Humidity (%)
                        </label>
                        <input type="number" id="humidity" class="input-field" placeholder="50">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1" for="altitude">
                            Altitude (ft)
                        </label>
                        <input type="number" id="altitude" class="input-field" placeholder="0">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1" for="wind-speed">
                            Wind Speed (mph)
                        </label>
                        <input type="number" id="wind-speed" class="input-field" placeholder="0">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1" for="wind-direction">
                            Wind Direction
                        </label>
                        <select id="wind-direction" class="input-field">
                            <option value="head">Headwind</option>
                            <option value="tail">Tailwind</option>
                            <option value="left">Left to Right</option>
                            <option value="right">Right to Left</option>
                        </select>
                    </div>
                </div>
                <div class="mt-4">
                    <button id="get-weather" class="btn-secondary">
                        <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/>
                        </svg>
                        Get Current Weather
                    </button>
                </div>
            </div>

            <!-- Club Distances Card -->
            <div class="card mb-8">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">Club Distances</h2>
                <div id="clubs" class="space-y-2"></div>
                <div class="mt-4 flex gap-4">
                    <button id="add-club" class="btn-secondary">
                        <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                        </svg>
                        Add Club
                    </button>
                    <button id="calculate" class="btn-primary">
                        <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
                        </svg>
                        Calculate
                    </button>
                </div>
            </div>

            <!-- Results Visualization -->
            <div class="card">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">Shot Analysis</h2>
                <canvas id="shotChart" class="w-full h-64 mb-4"></canvas>
                <div id="environmental-effect" class="p-4 bg-primary-50 rounded-lg text-primary-900"></div>
            </div>
        </main>
    </div>

    <script src="script.js"></script>
    <script>
        // Verify script loading
        console.log('Main script loaded');
        
        // Add test button
        function addTestButton() {
            console.log('Adding test button...');
            const buttonGroup = document.getElementById('main-buttons');
            if (!buttonGroup) {
                console.error('Button group not found');
                return;
            }
            
            const testButton = document.createElement('button');
            testButton.textContent = 'Run Tests';
            testButton.onclick = async function() {
                // Simple test function
                console.log('Running test...');
                const tempInput = document.getElementById('temperature');
                const humidityInput = document.getElementById('humidity');
                const altitudeInput = document.getElementById('altitude');
                const clubRow = document.querySelector('.club-row');
                
                if (!tempInput || !humidityInput || !altitudeInput || !clubRow) {
                    console.error('Required elements not found');
                    alert('Error: Required elements not found');
                    return;
                }
                
                // Set test values
                console.log('Setting test values...');
                tempInput.value = 70;
                humidityInput.value = 50;
                altitudeInput.value = 0;
                
                const distanceInput = clubRow.querySelector('.club-distance');
                if (distanceInput) {
                    distanceInput.value = 250;
                    console.log('Set distance to:', distanceInput.value);
                }
                
                // Trigger input events to ensure calculations update
                const event = new Event('input', { bubbles: true });
                tempInput.dispatchEvent(event);
                humidityInput.dispatchEvent(event);
                altitudeInput.dispatchEvent(event);
                distanceInput.dispatchEvent(event);
                
                // Calculate
                console.log('Calculating distances...');
                calculateAllDistances();
                
                // Wait a moment for calculations to complete
                await new Promise(resolve => setTimeout(resolve, 100));
                
                // Get result
                const adjustedElement = clubRow.querySelector('.adjusted-value');
                if (adjustedElement) {
                    const actualValue = parseFloat(adjustedElement.value || '0');
                    console.log('Test values:', {
                        temperature: tempInput.value,
                        humidity: humidityInput.value,
                        altitude: altitudeInput.value,
                        distance: distanceInput.value
                    });
                    console.log('Test result:', {
                        expected: 250,
                        actual: actualValue,
                        element: adjustedElement.value
                    });
                    
                    // Show result
                    const resultDiv = document.createElement('div');
                    resultDiv.style.cssText = 'position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:white;padding:20px;border-radius:8px;box-shadow:0 0 20px rgba(0,0,0,0.2);z-index:1000;';
                    resultDiv.innerHTML = `
                        <h2>Test Results</h2>
                        <p>Test Conditions:</p>
                        <ul>
                            <li>Temperature: ${tempInput.value}°F</li>
                            <li>Humidity: ${humidityInput.value}%</li>
                            <li>Altitude: ${altitudeInput.value}ft</li>
                            <li>Base Distance: ${distanceInput.value}yds</li>
                        </ul>
                        <p>Expected: 250 yards</p>
                        <p>Actual: ${actualValue} yards</p>
                        <p>Difference: ${Math.abs(actualValue - 250).toFixed(2)} yards</p>
                        <button onclick="this.parentElement.remove()" style="padding:5px 10px;margin-top:10px;">Close</button>
                    `;
                    document.body.appendChild(resultDiv);
                }
            };
            buttonGroup.appendChild(testButton);
            console.log('Test button added successfully');
        }
        
        // Add button when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', addTestButton);
        } else {
            addTestButton();
        }
    </script>
</body>
</html>